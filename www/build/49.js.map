{"version":3,"sources":["../../src/pages/map-tracker/map-tracker.module.ts","../../src/pages/map-tracker/map-tracker.ts"],"names":[],"mappings":"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","file":"49.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { MapTrackerPage } from './map-tracker';\n\n@NgModule({\n  declarations: [\n    MapTrackerPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(MapTrackerPage),\n  ],\n})\nexport class MapTrackerPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/map-tracker/map-tracker.module.ts","import { Component, ViewChild , ElementRef } from '@angular/core';\nimport { IonicPage, NavController, NavParams,LoadingController } from 'ionic-angular';\nimport { HttpClient, HttpParams } from '@angular/common/http';\nimport { GlobalProvider } from '../../providers/global/global';\nimport { GlobalFunctionsProvider } from '../../providers/global-functions/global-functions';\nimport { Subscription } from 'rxjs/Subscription';\nimport { LaunchNavigator, LaunchNavigatorOptions } from '@ionic-native/launch-navigator/ngx';\nimport { GlobalApiProvider } from '../../providers/global-api/global-api';\ndeclare var google;\n\n@IonicPage()\n@Component({\n  selector: 'page-map-tracker',\n  templateUrl: 'map-tracker.html',\n})\nexport class MapTrackerPage {\n  @ViewChild('map') mapElement: ElementRef;\n  map: any;\n  currentMapTrack = null;\n  positionSubscription: Subscription;\n  isTracking = false;\n  trackedRoute = [];\n  previousTracks = [];\n  LocationInterval:any;\n  loader:any;\n  staff_id:any;\n  memberDetails:any=[];\n  constructor(public navCtrl: NavController, public navParams: NavParams,public http: HttpClient, public gFn:GlobalFunctionsProvider,\n    public global: GlobalProvider,public loadingCtrl:LoadingController,private launchNavigator: LaunchNavigator,public global_api:GlobalApiProvider) {\n      this.staff_id=navParams.get('staff_id')\n      console.log(this.staff_id)\n      var Details:any=navParams.get('memberDetails')\n      // this.memberDetails=navParams.get('memberDetails')\n      \n      for(var key in Details){\n        var temp:any=Details[key]\n        temp=Object.keys(temp).reduce((c, k) => (c[k.toLowerCase()] = temp[k], c), {})\n        console.log(temp)\n        this.memberDetails.push(temp)\n      }\n      console.log(this.memberDetails)\n      // this.MedicineFlag=Object.keys(this.MedicineFlag).reduce((c, k) => (c[k.toLowerCase()] = this.MedicineFlag[k], c), {})\n  }\n\n  ionViewDidLoad() {\n    console.log('ionViewDidLoad MapTrackerPage');\n    this.ActivateMap(this.staff_id)\n  }\n  ActivateMap(key){\n    this.staff_id=key;\n    this.loader =this.loadingCtrl.create({});\n    this.loader.present();\n    // $('#map').show()\n    // this.getCurrentLocation()\n    this.GetLocation(key)\n}\nGetLocation(StaffDetail){\n  \n  \n  console.log('2')\n  clearInterval(this.LocationInterval)\n  this.fetchLocation(StaffDetail).then((x)=>{\n    if(!x){\n      this.gFn.presentToast('Connecting...') \n    }\n    else{\n      this.loader.dismiss()\n    }\n  })\n  this.LocationInterval=setInterval(()=>{\n    this.fetchLocation(StaffDetail).then((x)=>{\n      if(!x){\n        this.gFn.presentToast('Connection issue or Location Not Found') \n          this.loader.dismiss()\n          clearInterval(this.LocationInterval)\n      }\n      else{\n        this.loader.dismiss()\n      }\n    })\n  },60000)\n}\n\nfetchLocation(staff_id){\n  let mapOptions = {\n    zoom: 13,\n    mapTypeId: google.maps.MapTypeId.ROADMAP,\n    mapTypeControl: false,\n    streetViewControl: false,\n    fullscreenControl: false\n  }\n  console.log('1')\n  this.map = new google.maps.Map(this.mapElement.nativeElement, mapOptions);\n  return new Promise((resolve) => {\n    let Data = new HttpParams()\n      .set('staffId', staff_id )\n    this.http.post(this.global.APIURL + \"transports/getGPSLocation\", Data,{headers:this.global_api.getHeader()})\n      .subscribe((data: any) => {\n          if(data.SUCCESS && data.GETGPSLOCATION[0] && \n            (data.GETGPSLOCATION[0].latitude || data.GETGPSLOCATION[0].longitude)){\n            console.log('getLocation',data)\n            console.log('3')\n            this.addMarker(this.map,data.GETGPSLOCATION[0].latitude,data.GETGPSLOCATION[0].longitude);\n            let latLng = new google.maps.LatLng(data.GETGPSLOCATION[0].latitude,data.GETGPSLOCATION[0].longitude);\n            this.map.setCenter(latLng);\n            this.map.setZoom(16);\n            console.log('4')\n            resolve(true)\n          }\n          else{\n            resolve(false)\n          }\n      }, error => {\n        resolve(false)\n      \n      });\n  })\n}\naddMarker(map:any,lat1,lng1){\n\n  let marker = new google.maps.Marker({\n    map: map,\n    animation: google.maps.Animation.DROP,\n    position: {\n      lat: lat1,\n      lng: lng1\n    }\n  });\n  this.addInfoWindow(marker,lat1,lng1);\n}\naddInfoWindow(marker, lat1,lng1){\n  console.log(lat1 + ', ' + lng1)\n  google.maps.event.addListener(marker, 'click', () => {\n    console.log(lat1 + ', ' + lng1)\n    this.launchNavigator.navigate(lat1 + ', ' + lng1);\n    clearInterval(this.LocationInterval)\n  });\n}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/map-tracker/map-tracker.ts"],"sourceRoot":""}